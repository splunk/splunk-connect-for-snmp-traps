#Splunk Connect for SNMP Traps by Splunk, Inc.
#
#To the extent possible under law, the person who associated CC0 with
#Splunk Connect SNMP Traps has waived all copyright and related or neighboring rights
#to Splunk Connect for SNMP Traps.
#
#You should have received a copy of the CC0 legalcode along with this
#work.  If not, see <http://creativecommons.org/publicdomain/zero/1.0/>.
version: "3.7"

services:
  sc4snmp_trap:
    build:
      context: ..
      dockerfile: tests/Dockerfile
    hostname: sc4snmp_trap
#    command: -det
    ports:
      - "2162:2162/udp"
    stdin_open: true
    tty: true
    links:
      - splunk
    environment:
      - SPLUNK_HEC_URL=https://splunk:8088/services/collector/event
      - SPLUNK_HEC_TOKEN=${SPLUNK_HEC_TOKEN}
      - SPLUNK_HEC_TLS_VERIFY=${SPLUNK_HEC_TLS_VERIFY}
  splunk:
    build:
      context: ..
      dockerfile: splunk/Dockerfile
    hostname: splunk
    ports:
      - "8000:8000"
      - "8088:8088"
      - "8089"
    environment:
      - SPLUNK_HEC_TOKEN=${SPLUNK_HEC_TOKEN}
      - SPLUNK_PASSWORD=${SPLUNK_PASSWORD}
      - SPLUNK_START_ARGS=--accept-license
    volumes:
      - splunk-var:/opt/splunk/var

volumes:
  results:
    external: false
  splunk-var:
    external: false
